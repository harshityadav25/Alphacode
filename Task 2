import csv

# Step 1: Hardcoded stock prices
stock_prices = {
    "AAPL": 180,
    "TSLA": 250,
    "GOOGL": 140,
    "MSFT": 320
}

# Step 2: Get user input
portfolio = {}
print("Enter your stocks (type 'done' when finished):")

while True:
    stock = input("Stock symbol: ").upper()
    if stock == 'DONE':
        break
    if stock not in stock_prices:
        print("Stock not in price list. Try again.")
        continue
    try:
        quantity = int(input(f"Quantity of {stock}: "))
    except ValueError:
        print("Please enter a valid number.")
        continue
    portfolio[stock] = portfolio.get(stock, 0) + quantity

# Step 3: Calculate total value
total_value = 0
print("\nPortfolio Summary:")
for stock, qty in portfolio.items():
    price = stock_prices[stock]
    value = price * qty
    total_value += value
    print(f"{stock}: {qty} shares × ${price} = ${value}")

print(f"\nTotal Investment Value: ${total_value}")

# Step 4: Ask user to save
save_option = input("Save results to file? (yes/no): ").lower()
if save_option in ('yes', 'y'):
    file_type = input("Choose file type (.txt or .csv): ").lower()
    filename = input("Enter file name (without extension): ")

    if file_type == '.txt':
        with open(f"{filename}.txt", "w") as file:
            file.write("Stock Portfolio Summary\n")
            for stock, qty in portfolio.items():
                price = stock_prices[stock]
                value = price * qty
                file.write(f"{stock}: {qty} shares × ${price} = ${value}\n")
            file.write(f"\nTotal Investment Value: ${total_value}")
        print("Saved to", f"{filename}.txt")

    elif file_type == '.csv':
        with open(f"{filename}.csv", "w", newline='') as file:
            writer = csv.writer(file)
            writer.writerow(["Stock", "Quantity", "Price", "Value"])
            for stock, qty in portfolio.items():
                price = stock_prices[stock]
                value = price * qty
                writer.writerow([stock, qty, price, value])
            writer.writerow([])
            writer.writerow(["Total", "", "", total_value])
        print("Saved to", f"{filename}.csv")

    else:
        print("Unsupported file type. Skipping save.")
